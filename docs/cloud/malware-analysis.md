---
sidebar_position: 4
title: 🐛 Malware Analysis
---

:::info
Malware Analysis is a [SafeDep Cloud](./index.md) service. It is currently available as early preview and supports only `npm` packages.
:::

This document describes how to use [vet](https://github.com/safedep/vet) for analyzing open source packages for malicious code. This is a [SafeDep Cloud](./index.md) hosted service and supports scanning package artifacts available in public package registries (e.g. `npm`) only.

## Requirements

- You must have [vet](https://github.com/safedep/vet) `1.8.9` or above installed
- You must be onboarded to SafeDep Cloud and have access to

1. Tenant Domain
2. API Key

Refer to [SafeDep Cloud Quickstart](./quickstart.md) for more information on how to onboard and get an API key.

## Malicious Package Scanning with `vet`

### Configure `vet` with SafeDep Cloud

```shell
vet auth configure --tenant your-tenant-domain
```

> **Note:** You will be prompted to enter an API key.

Verify API connectivity and authentication with `vet`

```shell
vet auth verify
```

### Enable Experimental Command

The malware analysis command in `vet` is currently experimental. Enable it by setting the environment variable

```shell
export VET_ENABLE_PACKAGE_INSPECT_COMMAND=true
```

### Scan a Package

Scan an `npm` package for malware

```shell
vet inspect malware --purl pkg:/npm/llm-oracle@1.0.2
```

> **Note:** The package analysis will be performed asynchronously. The scanning usually takes a few minutes but may take longer depending on pending analysis tasks in the queue.

On scan completion, `vet` will show the status of the analysis and classify it as `MALICIOUS` or `SAFE`

![Scan Result](/img/llm-oracle-npm-malysis.png)

The analysis results can be exported as JSON using `--report-json` parameter

```shell
vet inspect malware \
  --purl pkg:/npm/llm-oracle@1.0.2 \
  --report-json /tmp/analysis.json
```